<script>
export default {
  data() {
    return {
      tplInfo: {
        "id": "4XxixG511AP",
        "svg": "<svg width=\"100%\" height=\"100%\" version=\"1.1\" viewBox=\"0 0 450 300\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><rect x=\"0\" y=\"0\" data-type=\"bg\" fill=\"#FFFFFF\" width=\"100%\" height=\"100%\"></rect><g><rect data-type=\"rect\" x=\"0\" y=\"0\" width=\"452\" height=\"178\" fill=\"rgba(251, 113, 133, 1)\" rx=\"0\" id=\"NrvFNMSHQIXrZQwRZyzFp\" transform=\"translate(-1,123)\"></rect><g x=\"0\" y=\"0\" id=\"pYlJvtikXjmDcjxKAFJMF\" transform=\"translate(18,25)\"><image href=\"\" data-type=\"logo\" width=\"73\" height=\"74\"></image></g><g id=\"bKtpZTaiHqLXOwKYFyiAL\" transform=\"translate(105,25)\"><text x=\"0\" y=\"0\" fill=\"#fb7185\" font-weight=\"bold\" font-style=\"normal\" font-family=\"-apple-system, &quot;Noto Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Nimbus Sans L&quot;, Arial, &quot;Liberation Sans&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Wenquanyi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;ST Heiti&quot;, SimHei, &quot;WenQuanYi Zen Hei Sharp&quot;, sans-serif\" font-size=\"30\" dominant-baseline=\"\" text-anchor=\"\" transform=\"translate(7,0)\"><tspan data-type=\"title\" dy=\"30\" x=\"0\" data-max=\"37\" data-len=\"6\" y=\"0\"></tspan><tspan data-type=\"title-placeholder\" data-max=\"37\" fill=\"transparent\" x=\"0\" y=\"0\" dy=\"30\">十</tspan></text></g><g id=\"oNsvnrWngMOuaMUDUFxKA\" transform=\"translate(103,76)\"><text x=\"0\" y=\"0\" fill=\"#67717C\" font-weight=\"normal\" font-style=\"normal\" font-family=\"-apple-system, &quot;Noto Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Nimbus Sans L&quot;, Arial, &quot;Liberation Sans&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Wenquanyi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;ST Heiti&quot;, SimHei, &quot;WenQuanYi Zen Hei Sharp&quot;, sans-serif\" font-size=\"20\" dominant-baseline=\"\" text-anchor=\"\" transform=\"translate(7,0)\"><tspan data-type=\"subTitle\" dy=\"20\" x=\"0\" data-max=\"54\" data-len=\"12\" y=\"0\"></tspan><tspan data-type=\"subTitle-placeholder\" data-max=\"54\" fill=\"transparent\" x=\"0\" y=\"0\" dy=\"20\">十</tspan></text></g><g id=\"FbMUWqKWKmWLEhxBGQOCQ\" transform=\"translate(17,139)\"><text x=\"0\" y=\"0\" fill=\"#FFFFFF\" font-weight=\"normal\" font-style=\"normal\" font-family=\"-apple-system, &quot;Noto Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Nimbus Sans L&quot;, Arial, &quot;Liberation Sans&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Wenquanyi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;ST Heiti&quot;, SimHei, &quot;WenQuanYi Zen Hei Sharp&quot;, sans-serif\" font-size=\"22\" dominant-baseline=\"\" text-anchor=\"\" transform=\"translate(7,0)\"><tspan data-type=\"field\" dy=\"22\" x=\"0\" data-count=\"4\" data-max=\"53\" data-len=\"11\" y=\"0\"></tspan><tspan data-type=\"field-placeholder4\" data-max=\"53\" fill=\"transparent\" x=\"0\" y=\"0\" dy=\"22\">十</tspan></text></g><g id=\"dBBqgYhTfTJfdmPRncOQy\" transform=\"translate(16,180)\"><text x=\"0\" y=\"0\" fill=\"#FFFFFF\" font-weight=\"normal\" font-style=\"normal\" font-family=\"-apple-system, &quot;Noto Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Nimbus Sans L&quot;, Arial, &quot;Liberation Sans&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Wenquanyi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;ST Heiti&quot;, SimHei, &quot;WenQuanYi Zen Hei Sharp&quot;, sans-serif\" font-size=\"22\" dominant-baseline=\"\" text-anchor=\"\" transform=\"translate(7,0)\"><tspan data-type=\"field\" dy=\"22\" x=\"0\" data-count=\"4\" data-max=\"53\" data-len=\"11\" y=\"0\"></tspan><tspan data-type=\"field-placeholder4\" data-max=\"53\" fill=\"transparent\" x=\"0\" y=\"0\" dy=\"22\">十</tspan></text></g><g id=\"FeRKXNEKxvGYtseDMzupj\" transform=\"translate(17,220)\"><text x=\"0\" y=\"0\" fill=\"#FFFFFF\" font-weight=\"normal\" font-style=\"normal\" font-family=\"-apple-system, &quot;Noto Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Nimbus Sans L&quot;, Arial, &quot;Liberation Sans&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Wenquanyi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;ST Heiti&quot;, SimHei, &quot;WenQuanYi Zen Hei Sharp&quot;, sans-serif\" font-size=\"22\" dominant-baseline=\"\" text-anchor=\"\" transform=\"translate(7,0)\"><tspan data-type=\"field\" dy=\"22\" x=\"0\" data-count=\"4\" data-max=\"53\" data-len=\"11\" y=\"0\"></tspan><tspan data-type=\"field-placeholder4\" data-max=\"53\" fill=\"transparent\" x=\"0\" y=\"0\" dy=\"22\">十</tspan></text></g><g id=\"VtozJtFoYMzEhlzZyanMG\" transform=\"translate(17,260)\"><text x=\"0\" y=\"0\" fill=\"#FFFFFF\" font-weight=\"normal\" font-style=\"normal\" font-family=\"-apple-system, &quot;Noto Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Nimbus Sans L&quot;, Arial, &quot;Liberation Sans&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Wenquanyi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;ST Heiti&quot;, SimHei, &quot;WenQuanYi Zen Hei Sharp&quot;, sans-serif\" font-size=\"22\" dominant-baseline=\"\" text-anchor=\"\" transform=\"translate(7,0)\"><tspan data-type=\"field\" dy=\"22\" x=\"0\" data-count=\"4\" data-max=\"53\" data-len=\"11\" y=\"0\"></tspan><tspan data-type=\"field-placeholder4\" data-max=\"53\" fill=\"transparent\" x=\"0\" y=\"0\" dy=\"22\">十</tspan></text></g><rect data-type=\"rect\" x=\"0\" y=\"0\" width=\"139\" height=\"139\" fill=\"#FFFFFF\" rx=\"6.95\" id=\"AjLWOHQWBaqwLiicqwRRc\" transform=\"translate(289,145)\"></rect><image x=\"0\" y=\"0\" data-type=\"qr\" href=\"\" width=\"129\" height=\"129\" id=\"yCOtjgjeFktovarkPtdhn\" transform=\"translate(294,150)\"></image></g></svg>",
        "defaultColor": "#FFFFFF",
        "defaultWidth": 150,
        "defaultHeight": 100,
        "hasLogo": true,
        "hasTitle": true,
        "hasSubTitle": true,
        "tagCount": 4,
      },
      tplData: {
        "id": "4XvmuiUeC2b",
        "width": 150,
        "height": 100,
        "backgroudColor": "#FFFFFF",
        "logo": "https://pinia.vuejs.org/logo.svg",
        "title": "朱鸿",
        "subTitle": "北包包包包包包包包包包包包包包包包包包包包包包包包",
        "tagFields": [
          "🥶🫠🥲🥸🥶🫠🥲🥲",
          "🫠🥲🥸🥶🫠🥲🥸🥶🫠",
          "🫠🥲🥸🥶🫠🥲🥸🥶",
          "🥲🥸🥶🫠🥲🥸🥶🫠🥲🥸",
        ],
      }
    }
  },
  methods: {
    showFocus(type, index, text) {
      this.$refs.QrCodeBinder.showFocus(type, index, text)
    },
    hiddenFocus() {
      this.$refs.QrCodeBinder.hiddenFocus()
    },
    uploadLogo(e) {
      const file = e.target.files[0]

      if(!file) return

      const blobURL = URL.createObjectURL(file)
      this.tplData.logo = blobURL
    },
  },
}
</script>

<template>
  <div class="w-full h-full flex">
    <div class="flex-1 flex justify-center items-center">
      <div :style="{ 'width': `${tplData.width}mm`, 'height': `${tplData.height}mm` }">
        <QrCodeBinder ref="QrCodeBinder" :tplInfo="tplInfo" :tplData="tplData" focusColor="rgba(124, 58, 237, 1)" />
      </div>
    </div>
    <div class="w-420px flex-none border-l p-4 flex flex-col gap-5">
      <template v-if="tplInfo.hasLogo">
        <label>LOGO</label>
        <input type="file" @change="uploadLogo">
      </template>
      <template v-if="tplInfo.hasTitle">
        <label>标题</label>
        <input @focus="showFocus('title', 0, '标题')" @blur="hiddenFocus" v-model="tplData.title" type="text" class="p-3 rounded text-black outline-none transition focus:(ring-3 ring-purple-600)">
      </template>
      <template v-if="tplInfo.hasSubTitle">
        <label>副标题</label>
        <input @focus="showFocus('subTitle', 0)" @blur="hiddenFocus" v-model="tplData.subTitle" type="text" class="p-3 rounded text-black outline-none transition focus:(ring-3 ring-purple-600)">
      </template>
      <template v-if="tplInfo.tagCount > 0">
        <label>字段</label>
        <input @focus="showFocus('field', i)" @blur="hiddenFocus" v-model="tplData.tagFields[i]" v-for="(t, i) of tplData.tagFields" :key="i" type="text" class="p-3 rounded text-black outline-none transition focus:(ring-3 ring-purple-600)">
      </template>
    </div>
  </div>
</template>
